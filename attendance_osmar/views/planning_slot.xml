<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="planning_view_form" model="ir.ui.view">
           <field name="name">planning.slot.Form</field>
           <field name="model">planning.slot</field>
           <field name="inherit_id" ref="planning.planning_view_form" />
           <field name="arch" type="xml">
               <xpath expr="//form" position="replace" >
                   <form js_class="planning_form">


                       <notebook>
                           <page string="Asistencia" name="asistencia"
                                 groups="attendance_osmar.register_attendance_planning">

                               <sheet string="Shift">
                                   <field name="attendance_check_ids">
                                   <tree string="Lines" editable="bottom" >
                                       <field name="hr_employee_id" />
                                       <field name="state" widget="selection"  />
                                       <field name="hr_attendance_id" readonly="1" force_save="1" />
                                       <field name="date"  optional="hidden" />

                                   </tree>

                               </field>

                               </sheet>



                           </page>

                           <page string="Editar" name="edit">


                               <header>
                           <button string="Publish &amp; Send" type="object" name="action_send" class="btn btn-primary" close="1" groups="planning.group_planning_manager" data-hotkey="q" invisible="context.get('search_default_my_shifts') or (state == 'published' or resource_type == 'material')"/>
                            <button name="action_self_assign" class="btn btn-primary" type="object" string="I Take It" groups="!planning.group_planning_manager" close="1" invisible="context.get('search_default_my_shifts') or (not is_users_role or is_past or not start_datetime or not end_datetime or resource_id and not request_to_switch or user_id == uid and (allow_self_unassign or request_to_switch))"/>
                    <button name="action_self_assign" class="btn btn-secondary" type="object" string="I Take It" groups="!planning.group_planning_manager" close="1" invisible="context.get('search_default_my_shifts') or (is_users_role or is_past or not start_datetime or not end_datetime or resource_id and not request_to_switch or user_id == uid and (allow_self_unassign or request_to_switch))"/>
                    <button name="action_switch_shift" class="btn btn-secondary" type="object" string="Ask To Switch" groups="!planning.group_planning_manager" invisible="not is_assigned_to_me or is_past or request_to_switch or allow_self_unassign"/>
                    <button name="action_cancel_switch" class="btn btn-secondary" type="object" string="Cancel Switch" groups="!planning.group_planning_manager" invisible="not start_datetime or not end_datetime or not request_to_switch or allow_self_unassign or user_id != uid and request_to_switch" close="1"/>

                    <button name="action_self_unassign" class="btn btn-secondary" type="object" string="I Am Unavailable" invisible="not context.get('search_default_my_shifts') or (not is_assigned_to_me or not allow_self_unassign or is_past or is_unassign_deadline_passed or resource_type == 'material')"/>
                    <button string="Send" type="object" name="action_send" class="btn btn-secondary" close="1" groups="planning.group_planning_manager" data-hotkey="v" invisible="context.get('search_default_my_shifts') or (state == 'draft' or resource_type == 'material')"/>
                    <button string="Reset to Draft" type="object" name="action_unpublish" class="btn btn-secondary" close="1" groups="planning.group_planning_manager" invisible="state == 'draft' or resource_type == 'material'" data-hotkey="q"/>
                    <button string="Auto Plan" type="object" name="auto_plan_id" class="btn btn-secondary" groups="planning.group_planning_manager" data-hotkey="p" invisible="context.get('search_default_my_shifts') or resource_id"/>
                    <field name="state" widget="statusbar" groups="planning.group_planning_manager" invisible="context.get('search_default_my_shifts')"/>
                </header>

                       <field name="is_past" invisible="1"/>
                       <field name="is_unassign_deadline_passed" invisible="1"/>
                       <field name="work_email" invisible="1"/>
                       <field name="previous_template_id" invisible="1"/>
                       <field name="template_reset" invisible="1"/>
                       <field name="employee_id" invisible="1"/>
                       <field name="user_id" invisible="1"/>
                       <field name="resource_type" invisible="1"/>
                       <field name="is_users_role" invisible="1"/>
                       <field name="request_to_switch" invisible="1"/>
                       <field name="repeat" invisible="1"/>
                       <field name="color" invisible="1"/>
                       <field name="attendance_check_ids" invisible="1"/>
                       <div class="alert alert-info oe_edit_only mb-0" role="status" invisible="not id or not repeat">
                    <span class="ms-2 me-4">Edit</span>
                    <field name="recurrence_update" widget="radio" class="mb-0" options="{'horizontal': true}"/>
                </div>
                       <div role="alert" class="alert alert-warning mb-0 p-3 text-center" invisible="overlap_slot_count == 0 and (not request_to_switch or allow_self_unassign)">
                           <span class="align-middle" invisible="overlap_slot_count == 0">Prepare for the ultimate multi-tasking challenge:</span>
                           <button name="action_see_overlaping_slots" type="object" class="btn-link pe-1" invisible="overlap_slot_count == 0">
                        <field name="overlap_slot_count"/> other shift(s)
                       </button>
                           <span class="align-middle" invisible="overlap_slot_count == 0">conflict.</span>
                           <p class="align-middle" invisible="not request_to_switch or allow_self_unassign" style="margin-bottom: 5.5px; margin-top: 5px">
                              <span>The employee assigned would like to switch shifts with someone else.</span>
                           </p>
                       </div>

                <sheet string="Shift">



                    <div class="oe_button_box" name="button_box">
                        <!-- Used by other modules-->
                    </div>
                    <field name="is_assigned_to_me" invisible="1"/>
                    <field name="allow_self_unassign" invisible="1"/>
                    <field name="template_id" domain="[['id', 'in', template_autocomplete_ids]]" widget="selection_badge" options="{'horizontal': true}" groups="planning.group_planning_manager" invisible="not template_autocomplete_ids and not template_id"/>
                    <field name="template_autocomplete_ids" invisible="1"/>
                    <field name="recurrency_id" invisible="1"/>
                    <group>
                        <group>
                            <field name="resource_id" context="{'search_view_ref': 'planning.resource_resource_search_view_roles', 'search_default_role_ids': role_id, 'from_planning': True, 'show_job_title': True, 'tree_view_ref': 'planning.resource_resource_tree_view_inherit'}" options="{'no_create_edit': True}" readonly="not start_datetime or not end_datetime" widget="many2one_avatar_resource" placeholder="Open Shift"/>
                            <field name="role_id" context="{'search_default_resource_ids': resource_id}" placeholder="e.g. Bartender"/>
                            <field name="company_id" groups="base.group_multi_company"/>
                            <field name="company_id" invisible="1"/>
                        </group>
                        <!-- slot_info_right group is used in another module -->
                        <group name="slot_info_right">
                            <field name="start_datetime" string="Date" widget="daterange" options="{'end_date_field': 'end_datetime'}"/>
                            <field name="end_datetime" invisible="1"/>
                            <label for="allocated_hours"/>
                            <div class="o_row">
                                <field name="allocated_hours" widget="float_time" class="oe_inline" required="resource_type == 'material'"/>
                                <span invisible="resource_type == 'material'">
                                    (<field name="allocated_percentage" class="oe_inline" decoration-danger="allocated_percentage &gt; 100"/> %)
                                </span>
                            </div>
                        </group>
                    </group>
                    <div class="my-4" groups="planning.group_planning_manager">
                        <div class="d-block d-md-flex">
                            <label for="repeat"/>
                            <field name="repeat"/>
                            <div class="o_checkbox_optional_field">
                                <div invisible="not repeat" class="d-flex">
                                    <label for="repeat_interval" string="Every"/>
                                    <field name="repeat_interval" class="ms-2" style="max-width: 4rem;"/>
                                    <field name="repeat_unit" class="ms-2"/>
                                    <field name="repeat_type" nolabel="1" class="ms-2" required="repeat"/>
                                    <field name="repeat_until" class="ms-2" nolabel="1" invisible="repeat_type != 'until'" required="repeat_type == 'until' and repeat"/>
                                    <field name="repeat_number" class="ms-2" invisible="repeat_type != 'x_times'" required="repeat_type == 'x_times' and repeat" style="max-width: 4rem;"/>
                                </div>
                            </div>
                        </div>
                    </div>
                    <field name="slot_properties" columns="2"/>
                    <field name="allow_template_creation" invisible="1"/>
                    <label for="template_creation" groups="planning.group_planning_manager"/>
                    <field name="template_creation" class="ms-2" nolabel="1" groups="planning.group_planning_manager"/>
                    <field name="name" nolabel="1" placeholder="Additional note sent to the employee"/>
                </sheet>



                           </page>

                       </notebook>


            </form>
               </xpath>
           </field>
    </record>


    <record id="action_attendance_check_state" model="ir.actions.act_window">
            <field name="name">Estados Asistencia</field>
            <field name="res_model">attendance.check.state</field>
            <field name="view_mode">tree,form</field>
    </record>

    <record id="attendance_check_state_form" model="ir.ui.view">
           <field name="name">attendance.check.state.Form</field>
           <field name="model">attendance.check.state</field>

           <field name="arch" type="xml">
               <form>
                   <group>
                       <field name="name" />
                       <field name="register_attendance" />
                       <field name="start_hour" />
                       <field name="end_end" />
                   </group>
               </form>
           </field>
    </record>



    <menuitem id="menu_attendance_check_state" name="Estados Asistencia"
              parent="planning.planning_menu_settings"
              action="action_attendance_check_state"
             />

</odoo>