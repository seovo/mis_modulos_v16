<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="paperformat_lot_id" model="report.paperformat">
            <field name="name">Report Format Lot</field>
            <field name="default" eval="True"/>
            <field name="format">custom</field>
            <field name="page_height">297</field>
            <field name="page_width">210</field>
            <field name="orientation">Portrait</field>
            <field name="margin_top">2</field>
            <field name="margin_bottom">5</field>
            <field name="margin_left">10</field>
            <field name="margin_right">10</field>
            <field name="header_line" eval="True"/>
            <field name="header_spacing">6</field>
            <field name="dpi">90</field>
    </record>


    <template id="report_report_lots">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <div class="row header" />
                <t t-call="land.report_lots_document"/>
            </t>
        </t>
    </template>


    <template id="report_lots_document">
        <t t-call="web.external_layout">
            <t t-set="doc" t-value="doc"/>
            <div class="page">

                <t t-set ="state_array" t-value="{
                                          'sale' : 'VENDIDO' ,
                                          'free' : 'LIBRE' ,
                                          'reserved' : 'SEPARADO'
                                      }" />
                <div class="oe_structure"/>
                <center><h1>REPORTE LOTES</h1></center>

                <t t-foreach="doc.product_template_attribute_value_ids" t-as="manzana_val">
                    <t t-if="manzana_val.attribute_id.type_land == 'mz'">
                        <table class="table ">
                            <thead>
                                <tr class="bg-primary text-white" >
                                    <th colspan="9" class=" text-center text-white">MANZANA <t t-esc="manzana_val.name" /></th>
                                </tr>

                                <tr class="bg-primary text-white">
                                   <th scope="col" class="text-white">NÂ° DE LOTE</th>
                                   <th scope="col" class="text-white">FORMA</th>
                                   <th scope="col" class="text-white">AREA</th>
                                   <th scope="col" class="text-white">FRENTE</th>
                                   <th scope="col" class="text-white">LARGO 1</th>
                                   <th scope="col" class="text-white">LARGO 2</th>
                                   <th scope="col" class="text-white">FONDO</th>
                                   <th scope="col" class="text-white">PRECIO</th>
                                   <th scope="col" class="text-white">ESTADO</th>

                                </tr>
                            </thead>

                            <tbody>

                                <t t-foreach="manzana_val.report_lot_land_line_ids" t-as="lot">


                                   <tr  t-attf-class="
                                #{'alert-danger' if lot.state == 'sale' else ''}
                                #{'alert-success' if lot.state == 'free' else ''}
                                #{'alert-warning' if lot.state == 'reserved' else ''}

                               ">
                                  <td style="background: none;"><t t-esc="manzana_val.name" /> - <t t-esc="lot.name" /></td>
                                  <td style="background: none;"><t t-esc="lot.shape" /></td>
                                  <td style="background: none;"><t t-esc="lot.area" /></td>
                                  <td style="background: none;"><t t-esc="lot.front" /></td>
                                  <td style="background: none;"><t t-esc="lot.large1" /></td>
                                  <td style="background: none;"><t t-esc="lot.large2" /></td>
                                  <td style="background: none;"><t t-esc="lot.background" /></td>
                                  <td style="background: none;"><t t-esc="lot.price" /></td>
                                  <td style="background: none;"><t t-esc="state_array[lot.state]" /></td>
                               </tr>


                                </t>

                                <tr class=" alert-danger ">
                                  <td style="background: none;" colspan="7" rowspan="3" >
                                   <center>
                                       MANZANA: <t t-esc="manzana_val.name" />
                                   </center>

                               </td>
                                  <td style="background: none;"  >VENDIDO </td>
                                  <td style="background: none;" class="alert-danger"><t t-esc="manzana_val.count_lot_sale" /></td>
                                </tr>
                                <tr class=" alert-warning ">
                                    <td style="background: none;" >SEPARADO</td>
                                    <td style="background: none;" class="alert-warning"><t t-esc="manzana_val.count_lot_separate" /></td>
                                </tr>
                                <tr class=" alert-success ">
                                    <td  style="background: none;" >LIBRE </td>
                                    <td style="background: none;" class=" alert-success "><t t-esc="manzana_val.count_lot_free" /></td>
                                </tr>


                             </tbody>

                        </table>

                        <div style="page-break-after: always;" t-if="manzana_val.attribute_id.type_land == 'mz'" />






                    </t>


                </t>


            </div>
        </t>
    </template>



    <record id="action_report_lot" model="ir.actions.report">
        <field name="name">REPORTE DE LOTES</field>
        <field name="model">product.template</field>
        <field name="report_type">qweb-html</field>
        <field name="report_name">land.report_report_lots</field>
        <field name="report_file">land.report_report_lots</field>
        <field name="print_report_name">('Reporte_Lotes').replace('/','_')</field>
        <field name="binding_model_id" ref="model_product_template"/>
        <field name="binding_type">report</field>
        <field name="paperformat_id" ref="land.paperformat_lot_id" />
    </record>



</odoo>