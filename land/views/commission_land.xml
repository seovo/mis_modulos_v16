<odoo>

    <record model="ir.ui.view" id="commission_land_tree" >
        <field name="name">commission.land.tree</field>
        <field name="model">commission.land</field>
        <field name="arch" type="xml">
            <tree string="GUIA"
                decoration-danger="state in ['cancel']"
                decoration-success="state in ['done']"
                decoration-warning="state in ['draft']"
                >
                <field name="name" />
                <field name="date_commission" />
                <field name="date_start" />
                <field name="date_end" />
                <field name="user_id" />
                <field name="amount_total" sum="Total" />
                <field name="state"
                       decoration-danger="state in ['cancel']"
                       decoration-success="state in ['done']"
                       decoration-warning="state in ['draft']"
                       widget="badge" />
            </tree>
        </field>
    </record>

    <record model="ir.ui.view" id="commission_land_search" >
        <field name="name">commission.land.search</field>
        <field name="model">commission.land</field>
        <field name="arch" type="xml">
            <search>

                <field name="name" />

                <field name="date_start" />
                <field name="date_end" />
                <field name="user_id" />

                <filter name="show_draft" string="Pendientes" domain="[('state', '=', 'draft')]" />
                <filter name="show_done" string="Pagados" domain="[('state', '=', 'done')]" />
                <filter name="show_cancel" string="Cancelados" domain="[('state', '=', 'cancel')]" />


                <group string="Group By..." expand="0" name="groupby">
                    <filter string="Equipo" name="group_team_id" context="{'group_by': 'team_id'}"/>
                    <filter string="Usuario" name="group_user_id" context="{'group_by': 'user_id'}"/>
                </group>
            </search>
        </field>
    </record>

    <record model="ir.ui.view" id="commission_land_form" >
        <field name="name">commission.land.form</field>
        <field name="model">commission.land</field>
        <field name="arch" type="xml">
            <form string="COMMISSION RIMAC">
                <header>
                    <!--
                     <button name="action_done"
                             string="Finalizar" type="object"
                             states="confirmed"
                           />

                    -->

                     <button name="action_draft"
                             string="Borrador" type="object"
                             states="done"
                           />

                    <button name="action_cancel"
                             string="CANCELAR" type="object"
                             states="draft"
                           />

                    <button name="update_comission"
                             string="Actualizar" type="object"
                             states="draft"
                           />

                     <button name="action_confirm"
                             string="Confirm" type="object"
                             states="draft"
                           />
                    <field name="state"
                           widget="statusbar"

                    />
                </header>
                <sheet>



                    <group>
                        <group>
                            <field name="user_id"  attrs="{'readonly': [('state', 'not in', ['draft'])]}" />
                            <field name="type_period_comission" attrs="{'readonly': [('state', 'not in', ['draft'])]}"  />
                            <field name="date_commission" attrs="{'readonly': [('state', 'not in', ['draft'])]}"  />
                        </group>
                        <group>
                            <field name="date_start" attrs="{'readonly': [('state', 'not in', ['draft'])]}" />
                            <field name="date_end" attrs="{'readonly': [('state', 'not in', ['draft'])]}" />
                            <field name="team_id" attrs="{'readonly': [('state', 'not in', ['draft'])]}"  />

                        </group>






                    </group>

                    <notebook>
                        <page string="Sales" name="account_move_line_ids">
                            <field name="line_ids" attrs="{'readonly': [('state', 'not in', ['draft'])]}"

                            >
                                <tree string="Commisiones"  editable="bottom">
                                    <field name="sale_id" optional="show"
                                           domain="[('diff_payment_comision','>',0)]" />
                                    <field name="mz_land" />
                                    <field name="lot_land" />
                                    <field name="nro_internal_land" />
                                    <field name="date_order" />
                                    <field name="date_sign_land" string="Fecha Contrato" />
                                    <field name="commision_lan" />
                                    <field name="amount" />
                                    <field name="desc" />
                                    <field name="subtotal" />

                                </tree>
                            </field>
                            <group name="note_group" col="6" class="mt-2 mt-md-0">
                            <group colspan="4">
                                   <field colspan="2" name="note"
                                          attrs="{'readonly': [('state', 'not in', ['draft'])]}"
                                          nolabel="1" placeholder="Observaciones..."/>
                            </group>
                            <group class="oe_subtotal_footer oe_right" colspan="2" name="sale_total">
                                <field name="amount_base" readonly="1" force_save="1" />
                                <field name="amount_discount"  readonly="1" force_save="1" />
                                <field name="amount_bonus"  readonly="1" force_save="1" />

                                <field name="amount_total"  readonly="1" force_save="1" />
                            </group>
                            <div class="clearfix"/>
                        </group>
                        </page>
                    </notebook>

                </sheet>


            </form>
        </field>
    </record>

    <record id="action_commission_land" model="ir.actions.act_window">
        <field name="name">Commission Terrenos</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">commission.land</field>
        <field name="view_mode">tree,form</field>
        <field name="context">
            {
               'search_default_group_team_id' : 1 ,
               'search_default_group_user_id' : 1 ,
            }
        </field>
    </record>


    <menuitem id="menu_commissionx_parent"
              parent="sale.sale_order_menu"
              sequence="100"
              name="Comisión"
    />

    <menuitem action="action_commission_land"
              id="menu_commissionx"
              parent="menu_commissionx_parent"
              sequence="100"
    />


    <!-- LINEA DE COMISION -->

    <record model="ir.ui.view" id="commission_land_line_tree" >
        <field name="name">commission.land.line.tree</field>
        <field name="model">commission.land.line</field>
        <field name="arch" type="xml">
            <tree create="false">

                <field name="nro_internal_land" />
                <field name="sale_id" optional="show" />
                <field name="mz_land" />
                <field name="lot_land" />
                <field name="user_id" />
                <field name="seller_lan_id" />
                <field name="date_order" />
                <field name="date_sign_land" string="Fecha Contrato" />
                <field name="commision_lan" />
                <field name="amount" />
                <field name="desc" />
                <field name="subtotal" />

            </tree>

        </field>
    </record>

    <record id="action_commission_land_line" model="ir.actions.act_window">
        <field name="name">Lineas de comisión</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">commission.land.line</field>
        <field name="view_mode">tree</field>

    </record>

    <menuitem action="action_commission_land_line"
              id="menu_commissionx_line"
              parent="menu_commissionx_parent"
              sequence="100"
    />

</odoo>